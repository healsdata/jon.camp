{{ define "main" }}
  <h1>{{ .Title }}</h1>

  {{/* Category filter */}}
  <div class="blog-filter">
    <label for="category-select">Category:</label>
    <select id="category-select">
      <option value="all">All</option>
      {{ range .Sections }}
      <option value="{{ .Title | urlize }}">{{ .Title }}</option>
      {{ end }}
    </select>
  </div>

  {{/* List all posts from all categories */}}
  <div class="blog-posts">
    {{ range sort .RegularPagesRecursive ".Lastmod" "desc" }}
      {{ partial "post-card.html" . }}
    {{ end }}
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const select = document.getElementById('category-select');
      const posts = document.querySelectorAll('.post-card');

      select.addEventListener('change', function() {
        const category = this.value;
        posts.forEach(post => {
          if (category === 'all' || post.dataset.category === category) {
            post.style.display = '';
          } else {
            post.style.display = 'none';
          }
        });
      });
    });
  </script>
{{ end }}
